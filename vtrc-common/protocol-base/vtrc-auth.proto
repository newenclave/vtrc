package vtrc_auth;

// index 51000

enum hash_variant {
    HASH_NONE       = 0;

    // ---- crc ----  //
    HASH_CRC_16     = 1;
    HASH_CRC_32     = 2;
    HASH_CRC_64     = 3;

    // ---- sha ----  //
    HASH_SHA2_256   = 10;

};

enum transformer_variant {
    TRANSFORM_NONE       = 0;
    TRANSFORM_ERSEEFOR   = 1;
};

message error_info {
    optional uint32 code        = 1;
    optional string description = 2;
}

message init_protocol {

    optional string     hello_message   = 1;
    optional bool       ready           = 2 [default = true];
    optional error_info error           = 3;

    repeated uint32 hash_supported      = 4; // @hash_variant
    repeated uint32 transform_supported = 5; // @transformer_variant
}

message client_selection {

    optional string     hello_message   = 1;
    optional bool       ready           = 2 [default = true];
    optional error_info error           = 3;

    optional uint32     hash            = 4 [default = 1]; // HASH_CRC_32
    optional uint32     transform       = 5; // default TRANSFORM_NONE
}

message transformer_setup {

    optional string     opt_message = 1;
    optional bool       ready       = 2;
    optional error_info error       = 3;

    optional bytes  salt1           = 4;
    optional bytes  salt2           = 5;
    optional bytes  session_key     = 6;
}

