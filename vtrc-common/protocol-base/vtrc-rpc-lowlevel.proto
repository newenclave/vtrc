import "google/protobuf/descriptor.proto";
import "vtrc-errors.proto";

package vtrc_rpc_lowlevel;

// index 51300

option cc_generic_services = true;

message options {
    optional uint32     secure_level    = 1 ;
    optional uint64     call_timeout    = 2 [default = 60000]; // milliseconds
    optional bool       wait            = 3 [default = true];
};

message rpc_options_type {
    optional options opt = 1;
};


extend google.protobuf.ServiceOptions {
    optional rpc_options_type service_options = 51301;
}

extend google.protobuf.MethodOptions {
    optional rpc_options_type  method_options = 51302;
}

message message_info {
    enum message_type_enum {
        MESSAGE_NONE            = 0; // invalid value for internal usage

        MESSAGE_CALL            = 1; // from client
        MESSAGE_EVENT           = 2; // from server

        MESSAGE_INSERTION_CALL  = 3; // from client
        MESSAGE_CALLBACK        = 4; // from server

        MESSAGE_SERVICE         = 5; // intervals
        MESSAGE_INTERNAL        = 6; // intervals
    }
    optional uint32 message_type                = 1 [default = 0];
                                                // @message_type_enum
}

message call_info {
    optional bytes service = 1; // we can use full_name for example or crc :]
    optional bytes method  = 2;
}

message lowlevel_unit {

    // --- header --- //
    optional uint64                      id      =  1;
    optional message_info                info    =  2;
    optional call_info                   call    =  3;
    optional vtrc_errors.error_container error   =  4;
    optional options                     opt     =  5;

    // --- //
    optional bytes request                       = 20;
    optional bytes response                      = 21;
}

