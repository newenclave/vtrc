import "google/protobuf/descriptor.proto";
import "vtrc-errors.proto";

package vtrc_rpc_lowlevel;

// index 51300

option cc_generic_services = true;

message options {
    optional uint32     secure_level    = 1 ;
    optional uint64     call_timeout    = 2 [default = 60000]; // milliseconds
    optional bool       wait            = 3 [default = true];
};

message rpc_options_type {
    optional options opt = 1;
};


extend google.protobuf.ServiceOptions {
    optional rpc_options_type service_options = 51301;
}

extend google.protobuf.MethodOptions {
    optional rpc_options_type  method_options = 51302;
}

message message_info {
    enum message_type_enum {
        MESSAGE_CALL        = 0;
        MESSAGE_EVENT       = 1;
        MESSAGE_CALLBACK    = 2;
        MESSAGE_SERVICE     = 3;
    }
    optional uint32 message_type                = 1 [default = 0];
                                                        // @message_type_enum
    optional bool wait_for_response             = 2 [default = true];
}

message call_info {
    optional bytes service = 1; // we can use full_name for example or crc :]
    optional bytes method  = 2;
}

message lowlevel_unit {

    // --- header --- //
    optional uint64                      id      =  1;
    optional message_info                info    =  2;
    optional call_info                   call    =  3;
    optional vtrc_errors.error_container error   =  4;

    // --- //
    optional bytes request                       = 20;
    optional bytes response                      = 21;
}

